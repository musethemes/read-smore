{"mappings":"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","sources":["src/read-smore.js","src/utils/index.js","demo/src/app.js"],"sourcesContent":["import { getWordCount, getCharCount, trimSpaces } from \"./utils\";\n\n\n'use strict';\n\n/**\n * Defaults\n */\nconst defaultOptions = {\n  blockClassName: 'read-smore',\n  wordsCount: 70,\n  charsCount: 150,\n  moreText: 'Read More',\n  lessText: 'Read Less',\n  ellipse: '...',\n  isInline: false,\n  animate: false,\n  animationDuration: 400\n};\n\n/**\n * ReadSmore\n * @param {HTML element} element\n * @param {Object} options\n * @returns\n */\nfunction ReadSmore(element, options) {\n  options = Object.assign({}, defaultOptions, options);\n\n  // Internal Settings\n  let settings = {\n    originalContentArr: [],\n    truncatedContentArr: [],\n  };\n\n  /**\n   * Init plugin\n   * Loop over instances and begin truncation procress\n   * @public\n   */\n  function init() {\n    document.fonts.ready.then(function() {\n      for (let i = 0, n = element.length; i < n; ++i) {\n        // Set the original height for animation purposes\n        if(options.animate) {\n          $(element[i]).attr('data-read-smore-full-height', Math.ceil($(element[i]).outerHeight(true)));\n        }\n\n        truncate(element[i], i);\n\n        // Set the truncated height for animation purposes\n        if(options.animate) {\n          $(element[i]).attr('data-read-smore-truncated-height', Math.ceil($(element[i]).outerHeight(true)));\n        }\n      }\n    });\n  }\n\n  /**\n   * Ellpise Content\n   * Handles content ellipse by words or charactes\n   * @param {String} str - content string.\n   * @param {Number} max - Number of words||chars2 to show before truncation.\n   * @param {Bool} isChars - is by chars\n   */\n  function ellipse(str, max, isChars = false) {\n    // Trim starting/ending empty spaces\n    const trimedSpaces = trimSpaces(str);\n    const ellipse = options.ellipse || '...';\n\n    if (isChars) {\n      return trimedSpaces.split('').slice(0, max).join('') + ellipse;\n    }\n\n    return trimedSpaces.split(/\\s+/).slice(0, max).join(' ') + ellipse;\n  }\n\n  /**\n   * Truncate Logic\n   * @param {HTML Elmenent} el - single element instance\n   * @param {Number} i - current instance index\n   */\n  function truncate(el, idx) {\n    // User defined word count or defaults\n    const numberWords = el.dataset.readSmoreWords || options.wordsCount;\n    // User defined chars (if exists) or defaults\n    const numberCount = el.dataset.readSmoreChars || options.wordsCount;\n    const originalContent = el.innerHTML;\n    // Ellipser: content, count, is chars bool\n    const truncateContent = ellipse(\n      originalContent,\n      numberCount,\n      el.dataset.readSmoreChars ? true : false\n    );\n    const originalContentCount = el.dataset.readSmoreWords\n      ? getWordCount(originalContent)\n      : getCharCount(originalContent);\n\n    settings.originalContentArr.push(originalContent);\n    settings.truncatedContentArr.push(truncateContent);\n\n    if (numberCount < originalContentCount) {\n      el.innerHTML = settings.truncatedContentArr[idx];\n      let self = idx;\n      createLink(self);\n    }\n  }\n\n  /**\n   * Create Link\n   * Creates and Inserts Read More Link\n   * @param {number} idx - index reference of looped item\n   */\n  function createLink(idx) {\n    const linkWrap = document.createElement('span');\n\n    linkWrap.className = `${options.blockClassName}__link-wrap`;\n\n    linkWrap.innerHTML = `<a id=${options.blockClassName}_${idx}\n                             class=${options.blockClassName}__link\n                             style=\"cursor:pointer;\">\n                             ${options.moreText}\n                          </a>`;\n\n    // Inset created link\n    element[idx].after(linkWrap);\n\n    // Call link click handler\n    handleLinkClick(idx);\n  }\n\n  /**\n   * Link Click Listener\n   * @param {number} index - index of clicked link\n   */\n  function handleLinkClick(idx) {\n    const link = document.querySelector(`#${options.blockClassName}_${idx}`);\n\n    link.addEventListener('click', (e) => {\n      element[idx].classList.toggle('is-expanded');\n      const target = e.currentTarget;\n      if (target.dataset.clicked !== 'true') {\n        element[idx].innerHTML = settings.originalContentArr[idx];\n        target.innerHTML = options.lessText;\n        target.dataset.clicked = true;\n\n        // Animate height, replace the content at the end\n        if(options.animate) {\n          $(element[idx]).css('height', $(element[idx]).attr('data-read-smore-truncated-height'));\n\n          $(element[idx]).animate({\n              height: $(element[idx]).attr('data-read-smore-full-height') + 'px'\n          }, options.animationDuration, function(){\n              $(this).height('auto');\n          });\n        }\n      } else {\n        target.innerHTML = options.moreText;\n        target.dataset.clicked = false;\n\n        // Animate height, replace the content at the end\n        if(options.animate) {\n          $(element[idx]).css({\n            'height': $(element[idx]).attr('data-read-smore-full-height'),\n            'overflow': 'hidden'\n          });\n\n          $(element[idx]).animate({\n              height: $(element[idx]).attr('data-read-smore-truncated-height') + 'px'\n          }, options.animationDuration, function(){\n              $(this).height('auto');\n              $(this).css('overflow', '');\n\n              element[idx].innerHTML = settings.truncatedContentArr[idx];\n          });\n        } else {\n          element[idx].innerHTML = settings.truncatedContentArr[idx];\n        }\n      }\n    });\n  }\n\n  // API\n  return {\n    init: init,\n  };\n}\n\nReadSmore.options = defaultOptions;\n\nexport default ReadSmore;\n","'use strict';\n\n/**\n * Count Words\n * Helper to handle word count.\n * @param {string} str - Target content string.\n */\nexport function countWords(str) {\n  return str.split(/\\s+/).length;\n}\n\n/**\n * Count Chars\n * Helper to count by character\n * @param {string} str - Target content string.\n */\nexport function getCharCount(str) {\n  return str.length;\n}\n\nexport function getWordCount(str) {\n  return str.length;\n}\n\nexport function noTags(str) {\n  return str.replace(/(<([^>]+)>)/gi, '');\n}\n\nexport function noSpacing(str) {\n  return str.replace(/\\s/g, '');\n}\n\nexport function trimSpaces(str) {\n  return str.replace(/(^\\s*)|(\\s*$)/gi, '');\n}\n\nexport function getTagsCount(str) {\n  const tags = /(<([^>]+)>)/gi;\n  return ((str || '').match(tags) || []).length;\n}\n","import ReadSmore from '../../src';\n\nconst readMores = document.querySelectorAll('.js-read-smore');\nconst RMs = ReadSmore(readMores);\n\nRMs.init();\n"],"names":["$db984b8bf9974eec$var$defaultOptions","blockClassName","wordsCount","charsCount","moreText","lessText","ellipse","isInline","animate","animationDuration","$db984b8bf9974eec$var$ReadSmore","element","options","Object","assign","settings","originalContentArr","truncatedContentArr","truncate","el","idx","dataset","readSmoreWords","numberCount","readSmoreChars","originalContent","innerHTML","truncateContent","str","max","isChars","trimedSpaces","replace","$1eef38cfda4b0c52$export$21f453ae16e69339","split","slice","join","ellipse1","originalContentCount","length","$1eef38cfda4b0c52$export$952353ec92227944","push","linkWrap","document","createElement","className","after","querySelector","addEventListener","e","classList","toggle","target","currentTarget","clicked","$","css","attr","height","this","overflow","handleLinkClick","createLink","init","fonts","ready","then","i","n","Math","ceil","outerHeight","querySelectorAll"],"version":3,"file":"index.da4fbfc2.js.map"}